# xfs 文件系统详解



## xfs 文件系统挂载选项

官方文档：https://www.kernel.org/doc/html/latest/admin-guide/xfs.html?highlight=fstrim



#### **allocsize=size**

设置延迟分配写出时缓冲的I / O文件结束预分配大小（默认大小为64KiB）。此选项的有效值是页面大小（通常为4KiB）到1GiB（含）之间，以2的幂为单位递增。

默认行为是动态文件末尾预分配大小，它使用一组启发式方法根据文件中的当前分配模式和对文件的访问模式来优化预分配大小。指定固定的allocsize值将关闭动态行为。



#### **attr2 or noattr2**

这些选项启用/禁用将内联扩展属性存储在磁盘上的方式的“机会主义”改进。当第一次选择attr2时使用新格式时（设置或删除扩展属性时），磁盘上超级块功能位字段将更新以反映该格式的使用。

默认行为由磁盘功能位确定，该功能位指示attr2行为处于活动状态。如果设置了任何一个安装选项，则它将成为文件系统使用的新默认值。

启用CRC的文件系统始终使用attr2格式，因此如果设置了noattr2 mount选项，它将拒绝该设置。



#### **discard or nodiscard (default)**

启用/禁用命令发布，以使块设备回收文件系统释放的空间。这对于SSD设备，精简配置的LUN和虚拟机映像很有用，但可能会影响性能。 

注意：当前，建议您使用fstrim应用程序丢弃未使用的块，而不是使用丢弃挂载选项，因为此选项对性能的影响非常严重。

